define("mod_homework/eventlinker",["exports","core/modal","../../../../lib/amd/src/ajax"],(function(_exports,_modal,_ajax){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal=_interopRequireDefault(_modal),_ajax=_interopRequireDefault(_ajax);_exports.init=async(cmid,homeworkid)=>{document.querySelector("#open-event-linker").addEventListener("click",(async()=>{_ajax.default.call([{methodname:"mod_homework_get_events_for_homework",args:{homeworkid:homeworkid},done:async function(response){const modal=await _modal.default.create({title:"Homework event linker",body:response.events,footer:'<button type="button" class="btn btn-primary" data-action="submit">Submit</button>\n<button type="button" class="btn btn-secondary" data-action="cancel">Cancel</button>',show:!0,removeOnClose:!0});modal.show(),response.events.includes("There are no available events to link")&&modal.hideFooter(),modal.getRoot().on("click",'[data-action="submit"]',(e=>{e.preventDefault(),function(modal,homeworkid,cmid){let selectedEvent=document.getElementById("evntlinkerform").querySelector('input[name="eventtolink"]:checked');selectedEvent?_ajax.default.call([{methodname:"mod_homework_homework_event_link",args:{homeworkid:homeworkid,course_module_id:cmid,eventid:selectedEvent.value},done:async function(response){modal.destroy(),location.reload()},fail:error=>{console.log("Error: ",error)}}]):alert("Please select an event!")}(modal,homeworkid,cmid)})),modal.getRoot().on("click",'[data-action="cancel"]',(e=>{e.preventDefault(),modal.destroy(),location.reload()}))},fail:error=>{console.error("Fail:",error)}}])}))}}));

//# sourceMappingURL=eventlinker.min.js.map