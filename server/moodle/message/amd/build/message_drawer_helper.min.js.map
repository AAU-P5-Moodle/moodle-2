{"version":3,"file":"message_drawer_helper.min.js","sources":["../src/message_drawer_helper.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Provides some helper functions to trigger actions in the message drawer.\r\n *\r\n * @module     core_message/message_drawer_helper\r\n * @copyright  2018 Ryan Wyllie <ryan@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport {publish, subscribe} from 'core/pubsub';\r\nimport MessageDrawerEvents from 'core_message/message_drawer_events';\r\n\r\n/** @property {boolean} Whether the drawer is ready or not */\r\nlet drawerMarkedReady = false;\r\n\r\n/**\r\n * Trigger an event to create a new conversation in the message drawer.\r\n *\r\n * @param {object} args\r\n * @param {Number} args.userId The user id to start a conversation.\r\n */\r\nexport const createConversationWithUser = async(args) => {\r\n    await waitForDrawerToLoad();\r\n    publish(MessageDrawerEvents.CREATE_CONVERSATION_WITH_USER, args);\r\n};\r\n\r\n/**\r\n * Trigger an event to hide the message drawer.\r\n */\r\nexport const hide = async() => {\r\n    await waitForDrawerToLoad();\r\n    publish(MessageDrawerEvents.HIDE);\r\n};\r\n\r\n/**\r\n * Trigger an event to show the message drawer.\r\n */\r\nexport const show = async() => {\r\n    await waitForDrawerToLoad();\r\n    publish(MessageDrawerEvents.SHOW);\r\n};\r\n\r\n/**\r\n * Trigger an event to show the given conversation.\r\n *\r\n * @param {object} args\r\n * @param {int} args.conversationId Id for the conversation to show.\r\n */\r\nexport const showConversation = async(args) => {\r\n    await waitForDrawerToLoad();\r\n    publish(MessageDrawerEvents.SHOW_CONVERSATION, args);\r\n};\r\n\r\n/**\r\n * Trigger an event to show messaging settings.\r\n */\r\nexport const showSettings = async() => {\r\n    await waitForDrawerToLoad();\r\n    publish(MessageDrawerEvents.SHOW_SETTINGS);\r\n};\r\n\r\n/**\r\n * Helper to wait for the drawer to be ready before performing an action.\r\n *\r\n * @returns {Promise<void>}\r\n */\r\nexport const waitForDrawerToLoad = () => new Promise((resolve) => {\r\n    if (drawerMarkedReady) {\r\n        resolve();\r\n    } else {\r\n        subscribe(MessageDrawerEvents.READY, resolve);\r\n    }\r\n});\r\n\r\n/**\r\n * Helper to allow the drawer to mark itself as ready.\r\n */\r\nexport const markDrawerReady = () => {\r\n    drawerMarkedReady = true;\r\n    publish(MessageDrawerEvents.READY);\r\n};\r\n"],"names":["e","_message_drawer_events","__esModule","default","drawerMarkedReady","_exports","createConversationWithUser","async","waitForDrawerToLoad","publish","MessageDrawerEvents","CREATE_CONVERSATION_WITH_USER","args","hide","HIDE","show","SHOW","showConversation","SHOW_CONVERSATION","showSettings","SHOW_SETTINGS","Promise","resolve","subscribe","READY","markDrawerReady"],"mappings":"8JAwBqE,IAAAA;;;;;;;0OAArEC,wBAAqED,EAArEC,yBAAqED,EAAAE,WAAAF,EAAAG,CAAAA,QAAAH,GAGrE,IAAII,mBAAoB,EAWtBC,SAAAC,2BAHwCC,mBAChCC,uBACN,EAAAC,iBAAQC,uBAAAA,QAAoBC,8BAA+BC,KAAK,EASlEP,SAAAQ,KAHkBN,gBACVC,uBACN,EAAAC,QAAOA,SAACC,uBAAmBP,QAACW,KAAK,EASnCT,SAAAU,KAHkBR,gBACVC,uBACN,EAAAC,QAAOA,SAACC,uBAAmBP,QAACa,KAAK,EAYnCX,SAAAY,iBAH8BV,mBACtBC,uBACN,EAAAC,iBAAQC,uBAAAA,QAAoBQ,kBAAmBN,KAAK,EAStDP,SAAAc,aAH0BZ,gBAClBC,uBACN,EAAAC,QAAOA,SAACC,uBAAmBP,QAACiB,cAAc,EAQvC,MAAMZ,oBAAsBA,IAAM,IAAIa,SAASC,UAC9ClB,kBACAkB,WAEA,EAAAC,mBAAUb,uBAAAA,QAAoBc,MAAOF,QACzC,IACDjB,SAAAG,oBAAAA,oBAQDH,SAAAoB,gBAH6BA,KAC3BrB,mBAAoB,GACpB,EAAAK,QAAOA,SAACC,uBAAmBP,QAACqB,MAAM,CACpC"}