{"version":3,"file":"modal_backdrop.min.js","sources":["../src/modal_backdrop.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Contain the logic for modal backdrops.\r\n *\r\n * @module     core/modal_backdrop\r\n * @copyright  2016 Ryan Wyllie <ryan@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\nimport $ from 'jquery';\r\nimport * as Notification from './notification';\r\nimport * as Fullscreen from './fullscreen';\r\n\r\nconst SELECTORS = {\r\n    ROOT: '[data-region=\"modal-backdrop\"]',\r\n};\r\n\r\nexport default class ModalBackdrop {\r\n    root = null;\r\n    isAttached = false;\r\n    attachmentPoint = null;\r\n\r\n    /**\r\n     * Constructor for ModalBackdrop.\r\n     *\r\n     * @class core/modal_backdrop\r\n     * @param {HTMLElement|jQuery} root The root element for the modal backdrop\r\n     */\r\n    constructor(root) {\r\n        this.root = $(root);\r\n        this.isAttached = false;\r\n        this.attachmentPoint = document.createElement('div');\r\n        document.body.append(this.attachmentPoint);\r\n\r\n        if (!this.root.is(SELECTORS.ROOT)) {\r\n            Notification.exception({message: 'Element is not a modal backdrop'});\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the root element of this modal backdrop.\r\n     *\r\n     * @method getRoot\r\n     * @return {object} jQuery object\r\n     */\r\n    getRoot() {\r\n        return this.root;\r\n    }\r\n\r\n    /**\r\n     * Gets the jQuery wrapped node that the Modal should be attached to.\r\n     *\r\n     * @returns {jQuery}\r\n     */\r\n    getAttachmentPoint() {\r\n        return $(Fullscreen.getElement() || this.attachmentPoint);\r\n    }\r\n\r\n    /**\r\n     * Add the modal backdrop to the page, if it hasn't already been added.\r\n     *\r\n     * @method attachToDOM\r\n     */\r\n    attachToDOM() {\r\n        this.getAttachmentPoint().append(this.root);\r\n\r\n        if (this.isAttached) {\r\n            return;\r\n        }\r\n\r\n        this.isAttached = true;\r\n    }\r\n\r\n    /**\r\n     * Set the z-index value for this backdrop.\r\n     *\r\n     * @method setZIndex\r\n     * @param {int} value The z-index value\r\n     */\r\n    setZIndex(value) {\r\n        this.root.css('z-index', value);\r\n    }\r\n\r\n    /**\r\n     * Check if this backdrop is visible.\r\n     *\r\n     * @method isVisible\r\n     * @return {bool}\r\n     */\r\n    isVisible() {\r\n        return this.root.hasClass('show');\r\n    }\r\n\r\n    /**\r\n     * Check if this backdrop has CSS transitions applied.\r\n     *\r\n     * @method hasTransitions\r\n     * @return {bool}\r\n     */\r\n    hasTransitions() {\r\n        return this.getRoot().hasClass('fade');\r\n    }\r\n\r\n    /**\r\n     * Display this backdrop. The backdrop will be attached to the DOM if it hasn't\r\n     * already been.\r\n     *\r\n     * @method show\r\n     */\r\n    show() {\r\n        if (this.isVisible()) {\r\n            return;\r\n        }\r\n\r\n        this.attachToDOM();\r\n        this.root.removeClass('hide').addClass('show');\r\n    }\r\n\r\n    /**\r\n     * Hide this backdrop.\r\n     *\r\n     * @method hide\r\n     */\r\n    hide() {\r\n        if (!this.isVisible()) {\r\n            return;\r\n        }\r\n\r\n        if (this.hasTransitions()) {\r\n            // Wait for CSS transitions to complete before hiding the element.\r\n            this.getRoot().one('transitionend webkitTransitionEnd oTransitionEnd', () => {\r\n                this.getRoot().removeClass('show').addClass('hide');\r\n            });\r\n        } else {\r\n            this.getRoot().removeClass('show').addClass('hide');\r\n        }\r\n\r\n        // Ensure the modal is moved onto the body node if it is still attached to the DOM.\r\n        if ($(document.body).find(this.getRoot()).length) {\r\n            $(document.body).append(this.getRoot());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Remove this backdrop from the DOM.\r\n     *\r\n     * @method destroy\r\n     */\r\n    destroy() {\r\n        this.root.remove();\r\n        this.attachmentPoint.remove();\r\n    }\r\n}\r\n"],"names":["e","_getRequireWildcardCache","WeakMap","r","t","_interopRequireWildcard","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_jquery","Notification","Fullscreen","SELECTORS","_exports","root","isAttached","attachmentPoint","constructor","this","$","document","createElement","body","append","is","exception","message","getRoot","getAttachmentPoint","getElement","attachToDOM","setZIndex","value","css","isVisible","hasClass","hasTransitions","show","removeClass","addClass","hide","one","find","length","destroy","remove"],"mappings":"sIAwB2C,IAAAA;;;;;;;KAAA,SAAAC,yBAAAD,GAAA,GAAA,mBAAAE,QAAA,OAAA,KAAA,IAAAC,EAAAD,IAAAA,QAAAE,EAAAF,IAAAA,eAAAD,yBAAA,SAAAD,GAAAA,OAAAA,EAAAI,EAAAD,IAAAH,EAAA,CAAA,SAAAK,wBAAAL,EAAAG,GAAAA,IAAAA,GAAAH,GAAAA,EAAAM,WAAAN,OAAAA,EAAAA,GAAAA,OAAAA,GAAAA,iBAAAA,GAAAA,mBAAAA,EAAAO,MAAAA,CAAAA,QAAAP,GAAAI,IAAAA,EAAAH,yBAAAE,GAAA,GAAAC,GAAAA,EAAAI,IAAAR,GAAA,OAAAI,EAAAK,IAAAT,GAAA,IAAAU,EAAA,CAAAC,UAAA,MAAAC,EAAAC,OAAAC,gBAAAD,OAAAE,yBAAA,IAAA,IAAAC,KAAAhB,EAAAgB,GAAAA,YAAAA,GAAAC,CAAAA,EAAAA,eAAAC,KAAAlB,EAAAgB,GAAAG,CAAAA,IAAAA,EAAAP,EAAAC,OAAAE,yBAAAf,EAAAgB,GAAAG,KAAAA,IAAAA,EAAAV,KAAAU,EAAAC,KAAAP,OAAAC,eAAAJ,EAAAM,EAAAG,GAAAT,EAAAM,GAAAhB,EAAAgB,GAAAN,OAAAA,EAAAH,QAAAP,EAAAI,GAAAA,EAAAgB,IAAApB,EAAAU,GAAAA,CAAA,iFAF3CW,SAE2CrB,EAF3CqB,UAE2CrB,EAAAM,WAAAN,EAAAO,CAAAA,QAAAP,GAD3CsB,aAAAjB,wBAAAiB,cACAC,WAAAlB,wBAAAkB,YAEA,MAAMC,eACI,iCA0IT,OAAAC,SAAAlB,QAvIc,MACXmB,KAAO,KACPC,YAAa,EACbC,gBAAkB,KAQlBC,WAAAA,CAAYH,MACRI,KAAKJ,MAAO,EAAAK,QAACxB,SAACmB,MACdI,KAAKH,YAAa,EAClBG,KAAKF,gBAAkBI,SAASC,cAAc,OAC9CD,SAASE,KAAKC,OAAOL,KAAKF,iBAErBE,KAAKJ,KAAKU,GAAGZ,iBACdF,aAAae,UAAU,CAACC,QAAS,mCAEzC,CAQAC,OAAAA,GACI,OAAOT,KAAKJ,IAChB,CAOAc,kBAAAA,GACI,OAAO,EAAAT,QAAAA,SAAER,WAAWkB,cAAgBX,KAAKF,gBAC7C,CAOAc,WAAAA,GACIZ,KAAKU,qBAAqBL,OAAOL,KAAKJ,MAElCI,KAAKH,aAITG,KAAKH,YAAa,EACtB,CAQAgB,SAAAA,CAAUC,OACNd,KAAKJ,KAAKmB,IAAI,UAAWD,MAC7B,CAQAE,SAAAA,GACI,OAAOhB,KAAKJ,KAAKqB,SAAS,OAC9B,CAQAC,cAAAA,GACI,OAAOlB,KAAKS,UAAUQ,SAAS,OACnC,CAQAE,IAAAA,GACQnB,KAAKgB,cAIThB,KAAKY,cACLZ,KAAKJ,KAAKwB,YAAY,QAAQC,SAAS,QAC3C,CAOAC,IAAAA,GACStB,KAAKgB,cAINhB,KAAKkB,iBAELlB,KAAKS,UAAUc,IAAI,oDAAoD,KACnEvB,KAAKS,UAAUW,YAAY,QAAQC,SAAS,OAAO,IAGvDrB,KAAKS,UAAUW,YAAY,QAAQC,SAAS,SAI5C,EAAApB,QAACxB,SAACyB,SAASE,MAAMoB,KAAKxB,KAAKS,WAAWgB,SACtC,EAAAxB,QAACxB,SAACyB,SAASE,MAAMC,OAAOL,KAAKS,WAErC,CAOAiB,OAAAA,GACI1B,KAAKJ,KAAK+B,SACV3B,KAAKF,gBAAgB6B,QACzB,GACHhC,SAAAlB,OAAA"}