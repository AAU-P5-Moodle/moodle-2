{"version":3,"file":"imagedetails.min.js","sources":["../src/imagedetails.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Tiny media plugin image details class for Moodle.\r\n *\r\n * @module      tiny_media/imagedetails\r\n * @copyright   2024 Meirza <meirza.arson@moodle.com>\r\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport Config from 'core/config';\r\nimport ModalEvents from 'core/modal_events';\r\nimport Notification from 'core/notification';\r\nimport Pending from 'core/pending';\r\nimport Selectors from './selectors';\r\nimport Templates from 'core/templates';\r\nimport {getString} from 'core/str';\r\nimport {ImageInsert} from 'tiny_media/imageinsert';\r\nimport {\r\n    bodyImageInsert,\r\n    footerImageInsert,\r\n    showElements,\r\n    hideElements,\r\n    isPercentageValue,\r\n} from 'tiny_media/imagehelpers';\r\n\r\nexport class ImageDetails {\r\n    DEFAULTS = {\r\n        WIDTH: 160,\r\n        HEIGHT: 160,\r\n    };\r\n\r\n    rawImageDimensions = null;\r\n\r\n    constructor(\r\n        root,\r\n        editor,\r\n        currentModal,\r\n        canShowFilePicker,\r\n        canShowDropZone,\r\n        currentUrl,\r\n        image,\r\n    ) {\r\n        this.root = root;\r\n        this.editor = editor;\r\n        this.currentModal = currentModal;\r\n        this.canShowFilePicker = canShowFilePicker;\r\n        this.canShowDropZone = canShowDropZone;\r\n        this.currentUrl = currentUrl;\r\n        this.image = image;\r\n    }\r\n\r\n    init = function() {\r\n        this.currentModal.setTitle(getString('imagedetails', 'tiny_media'));\r\n        this.imageTypeChecked();\r\n        this.presentationChanged();\r\n        this.storeImageDimensions(this.image);\r\n        this.setImageDimensions();\r\n        this.registerEventListeners();\r\n    };\r\n\r\n    /**\r\n     * Loads and displays a preview image based on the provided URL, and handles image loading events.\r\n     */\r\n    loadInsertImage = async function() {\r\n        const templateContext = {\r\n            elementid: this.editor.id,\r\n            showfilepicker: this.canShowFilePicker,\r\n            showdropzone: this.canShowDropZone,\r\n        };\r\n\r\n        Promise.all([bodyImageInsert(templateContext, this.root), footerImageInsert(templateContext, this.root)])\r\n            .then(() => {\r\n                const imageinsert = new ImageInsert(\r\n                    this.root,\r\n                    this.editor,\r\n                    this.currentModal,\r\n                    this.canShowFilePicker,\r\n                    this.canShowDropZone,\r\n                );\r\n                imageinsert.init();\r\n                return;\r\n            })\r\n            .catch(error => {\r\n                window.console.log(error);\r\n            });\r\n    };\r\n\r\n    storeImageDimensions(image) {\r\n        // Store dimensions of the raw image, falling back to defaults for images without dimensions (e.g. SVG).\r\n        this.rawImageDimensions = {\r\n            width: image.width || this.DEFAULTS.WIDTH,\r\n            height: image.height || this.DEFAULTS.HEIGHT,\r\n        };\r\n\r\n        const getCurrentWidth = (element) => {\r\n            if (element.value === '') {\r\n                element.value = this.rawImageDimensions.width;\r\n            }\r\n            return element.value;\r\n        };\r\n\r\n        const getCurrentHeight = (element) => {\r\n            if (element.value === '') {\r\n                element.value = this.rawImageDimensions.height;\r\n            }\r\n            return element.value;\r\n        };\r\n\r\n        const widthInput = this.root.querySelector(Selectors.IMAGE.elements.width);\r\n        const currentWidth = getCurrentWidth(widthInput);\r\n\r\n        const heightInput = this.root.querySelector(Selectors.IMAGE.elements.height);\r\n        const currentHeight = getCurrentHeight(heightInput);\r\n\r\n        const preview = this.root.querySelector(Selectors.IMAGE.elements.preview);\r\n        preview.setAttribute('src', image.src);\r\n        preview.style.display = '';\r\n\r\n        // Ensure the checkbox always in unchecked status when an image loads at first.\r\n        const constrain = this.root.querySelector(Selectors.IMAGE.elements.constrain);\r\n        if (isPercentageValue(currentWidth) && isPercentageValue(currentHeight)) {\r\n            constrain.checked = currentWidth === currentHeight;\r\n        } else if (image.width === 0 || image.height === 0) {\r\n            // If we don't have both dimensions of the image, we can't auto-size it, so disable control.\r\n            constrain.disabled = 'disabled';\r\n        } else {\r\n            // This is the same as comparing to 3 decimal places.\r\n            const widthRatio = Math.round(100 * parseInt(currentWidth, 10) / image.width);\r\n            const heightRatio = Math.round(100 * parseInt(currentHeight, 10) / image.height);\r\n            constrain.checked = widthRatio === heightRatio;\r\n        }\r\n\r\n        /**\r\n         * Sets the selected size option based on current width and height values.\r\n         *\r\n         * @param {number} currentWidth - The current width value.\r\n         * @param {number} currentHeight - The current height value.\r\n         */\r\n        const setSelectedSize = (currentWidth, currentHeight) => {\r\n            if (this.rawImageDimensions.width === currentWidth &&\r\n                this.rawImageDimensions.height === currentHeight\r\n            ) {\r\n                this.currentWidth = this.rawImageDimensions.width;\r\n                this.currentHeight = this.rawImageDimensions.height;\r\n                this.sizeChecked('original');\r\n            } else {\r\n                this.currentWidth = currentWidth;\r\n                this.currentHeight = currentHeight;\r\n                this.sizeChecked('custom');\r\n            }\r\n        };\r\n\r\n        setSelectedSize(Number(currentWidth), Number(currentHeight));\r\n    }\r\n\r\n    /**\r\n     * Handles the selection of image size options and updates the form inputs accordingly.\r\n     *\r\n     * @param {string} option - The selected image size option (\"original\" or \"custom\").\r\n     */\r\n    sizeChecked(option) {\r\n        const widthInput = this.root.querySelector(Selectors.IMAGE.elements.width);\r\n        const heightInput = this.root.querySelector(Selectors.IMAGE.elements.height);\r\n        if (option === \"original\") {\r\n            this.sizeOriginalChecked();\r\n            widthInput.value = this.rawImageDimensions.width;\r\n            heightInput.value = this.rawImageDimensions.height;\r\n        } else if (option === \"custom\") {\r\n            this.sizeCustomChecked();\r\n            widthInput.value = this.currentWidth;\r\n            heightInput.value = this.currentHeight;\r\n\r\n            // If the current size is equal to the original size, then check the Keep proportion checkbox.\r\n            if (this.currentWidth === this.rawImageDimensions.width && this.currentHeight === this.rawImageDimensions.height) {\r\n                const constrainField = this.root.querySelector(Selectors.IMAGE.elements.constrain);\r\n                constrainField.checked = true;\r\n            }\r\n        }\r\n        this.autoAdjustSize();\r\n    }\r\n\r\n    autoAdjustSize(forceHeight = false) {\r\n        // If we do not know the image size, do not do anything.\r\n        if (!this.rawImageDimensions) {\r\n            return;\r\n        }\r\n\r\n        const widthField = this.root.querySelector(Selectors.IMAGE.elements.width);\r\n        const heightField = this.root.querySelector(Selectors.IMAGE.elements.height);\r\n\r\n        const normalizeFieldData = (fieldData) => {\r\n            fieldData.isPercentageValue = !!isPercentageValue(fieldData.field.value);\r\n            if (fieldData.isPercentageValue) {\r\n                fieldData.percentValue = parseInt(fieldData.field.value, 10);\r\n                fieldData.pixelSize = this.rawImageDimensions[fieldData.type] / 100 * fieldData.percentValue;\r\n            } else {\r\n                fieldData.pixelSize = parseInt(fieldData.field.value, 10);\r\n                fieldData.percentValue = fieldData.pixelSize / this.rawImageDimensions[fieldData.type] * 100;\r\n            }\r\n\r\n            return fieldData;\r\n        };\r\n\r\n        const getKeyField = () => {\r\n            const getValue = () => {\r\n                if (forceHeight) {\r\n                    return {\r\n                        field: heightField,\r\n                        type: 'height',\r\n                    };\r\n                } else {\r\n                    return {\r\n                        field: widthField,\r\n                        type: 'width',\r\n                    };\r\n                }\r\n            };\r\n\r\n            const currentValue = getValue();\r\n            if (currentValue.field.value === '') {\r\n                currentValue.field.value = this.rawImageDimensions[currentValue.type];\r\n            }\r\n\r\n            return normalizeFieldData(currentValue);\r\n        };\r\n\r\n        const getRelativeField = () => {\r\n            if (forceHeight) {\r\n                return normalizeFieldData({\r\n                    field: widthField,\r\n                    type: 'width',\r\n                });\r\n            } else {\r\n                return normalizeFieldData({\r\n                    field: heightField,\r\n                    type: 'height',\r\n                });\r\n            }\r\n        };\r\n\r\n        // Now update with the new values.\r\n        const constrainField = this.root.querySelector(Selectors.IMAGE.elements.constrain);\r\n        if (constrainField.checked) {\r\n            const keyField = getKeyField();\r\n            const relativeField = getRelativeField();\r\n            // We are keeping the image in proportion.\r\n            // Calculate the size for the relative field.\r\n            if (keyField.isPercentageValue) {\r\n                // In proportion, so the percentages are the same.\r\n                relativeField.field.value = keyField.field.value;\r\n                relativeField.percentValue = keyField.percentValue;\r\n            } else {\r\n                relativeField.pixelSize = Math.round(\r\n                    keyField.pixelSize / this.rawImageDimensions[keyField.type] * this.rawImageDimensions[relativeField.type]\r\n                );\r\n                relativeField.field.value = relativeField.pixelSize;\r\n            }\r\n        }\r\n\r\n        // Store the custom width and height to reuse.\r\n        this.currentWidth = Number(widthField.value) !== this.rawImageDimensions.width ? widthField.value : this.currentWidth;\r\n        this.currentHeight = Number(heightField.value) !== this.rawImageDimensions.height ? heightField.value : this.currentHeight;\r\n    }\r\n\r\n    /**\r\n     * Sets the dimensions of the image preview element based on user input and constraints.\r\n     */\r\n    setImageDimensions = () => {\r\n        const imagePreviewBox = this.root.querySelector(Selectors.IMAGE.elements.previewBox);\r\n        const image = this.root.querySelector(Selectors.IMAGE.elements.preview);\r\n        const widthField = this.root.querySelector(Selectors.IMAGE.elements.width);\r\n        const heightField = this.root.querySelector(Selectors.IMAGE.elements.height);\r\n\r\n        const updateImageDimensions = () => {\r\n            // Get the latest dimensions of the preview box for responsiveness.\r\n            const boxWidth = imagePreviewBox.clientWidth;\r\n            const boxHeight = imagePreviewBox.clientHeight;\r\n            // Get the new width and height for the image.\r\n            const dimensions = this.fitSquareIntoBox(widthField.value, heightField.value, boxWidth, boxHeight);\r\n            image.style.width = `${dimensions.width}px`;\r\n            image.style.height = `${dimensions.height}px`;\r\n        };\r\n        // If the client size is zero, then get the new dimensions once the modal is shown.\r\n        if (imagePreviewBox.clientWidth === 0) {\r\n            // Call the shown event.\r\n            this.currentModal.getRoot().on(ModalEvents.shown, () => {\r\n                updateImageDimensions();\r\n            });\r\n        } else {\r\n            updateImageDimensions();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Handles the selection of the \"Original Size\" option and updates the form elements accordingly.\r\n     */\r\n    sizeOriginalChecked() {\r\n        this.root.querySelector(Selectors.IMAGE.elements.sizeOriginal).checked = true;\r\n        this.root.querySelector(Selectors.IMAGE.elements.sizeCustom).checked = false;\r\n        hideElements(Selectors.IMAGE.elements.properties, this.root);\r\n    }\r\n\r\n    /**\r\n     * Handles the selection of the \"Custom Size\" option and updates the form elements accordingly.\r\n     */\r\n    sizeCustomChecked() {\r\n        this.root.querySelector(Selectors.IMAGE.elements.sizeOriginal).checked = false;\r\n        this.root.querySelector(Selectors.IMAGE.elements.sizeCustom).checked = true;\r\n        showElements(Selectors.IMAGE.elements.properties, this.root);\r\n    }\r\n\r\n    /**\r\n     * Handles changes in the image presentation checkbox and enables/disables the image alt text input accordingly.\r\n     */\r\n    presentationChanged() {\r\n        const presentation = this.root.querySelector(Selectors.IMAGE.elements.presentation);\r\n        const alt = this.root.querySelector(Selectors.IMAGE.elements.alt);\r\n        alt.disabled = presentation.checked;\r\n\r\n        // Counting the image description characters.\r\n        this.handleKeyupCharacterCount();\r\n    }\r\n\r\n    /**\r\n     * This function checks whether an image URL is local (within the same website's domain) or external (from an external source).\r\n     * Depending on the result, it dynamically updates the visibility and content of HTML elements in a user interface.\r\n     * If the image is local then we only show it's filename.\r\n     * If the image is external then it will show full URL and it can be updated.\r\n     */\r\n    imageTypeChecked() {\r\n        const regex = new RegExp(`${Config.wwwroot}`);\r\n\r\n        // True if the URL is from external, otherwise false.\r\n        const isExternalUrl = regex.test(this.currentUrl) === false;\r\n\r\n        // Hide the URL input.\r\n        hideElements(Selectors.IMAGE.elements.url, this.root);\r\n\r\n        if (!isExternalUrl) {\r\n            // Split the URL by '/' to get an array of segments.\r\n            const segments = this.currentUrl.split('/');\r\n            // Get the last segment, which should be the filename.\r\n            const filename = segments.pop().split('?')[0];\r\n            // Show the file name.\r\n            this.setFilenameLabel(decodeURI(filename));\r\n        } else {\r\n\r\n            this.setFilenameLabel(decodeURI(this.currentUrl));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the string for the URL label element.\r\n     *\r\n     * @param {string} label - The label text to set.\r\n     */\r\n    setFilenameLabel(label) {\r\n        const urlLabelEle = this.root.querySelector(Selectors.IMAGE.elements.fileNameLabel);\r\n        if (urlLabelEle) {\r\n            urlLabelEle.innerHTML = label;\r\n            urlLabelEle.setAttribute(\"title\", label);\r\n        }\r\n    }\r\n\r\n    toggleAriaInvalid(selectors, predicate) {\r\n        selectors.forEach((selector) => {\r\n            const elements = this.root.querySelectorAll(selector);\r\n            elements.forEach((element) => element.setAttribute('aria-invalid', predicate));\r\n        });\r\n    }\r\n\r\n    hasErrorUrlField() {\r\n        const urlError = this.currentUrl === '';\r\n        if (urlError) {\r\n            showElements(Selectors.IMAGE.elements.urlWarning, this.root);\r\n        } else {\r\n            hideElements(Selectors.IMAGE.elements.urlWarning, this.root);\r\n        }\r\n        this.toggleAriaInvalid([Selectors.IMAGE.elements.url], urlError);\r\n\r\n        return urlError;\r\n    }\r\n\r\n    hasErrorAltField() {\r\n        const alt = this.root.querySelector(Selectors.IMAGE.elements.alt).value;\r\n        const presentation = this.root.querySelector(Selectors.IMAGE.elements.presentation).checked;\r\n        const imageAltError = alt === '' && !presentation;\r\n        if (imageAltError) {\r\n            showElements(Selectors.IMAGE.elements.altWarning, this.root);\r\n        } else {\r\n            hideElements(Selectors.IMAGE.elements.urlWaaltWarningrning, this.root);\r\n        }\r\n        this.toggleAriaInvalid([Selectors.IMAGE.elements.alt, Selectors.IMAGE.elements.presentation], imageAltError);\r\n\r\n        return imageAltError;\r\n    }\r\n\r\n    updateWarning() {\r\n        const urlError = this.hasErrorUrlField();\r\n        const imageAltError = this.hasErrorAltField();\r\n\r\n        return urlError || imageAltError;\r\n    }\r\n\r\n    getImageContext() {\r\n        // Check if there are any accessibility issues.\r\n        if (this.updateWarning()) {\r\n            return null;\r\n        }\r\n\r\n        const classList = [];\r\n        const constrain = this.root.querySelector(Selectors.IMAGE.elements.constrain).checked;\r\n        const sizeOriginal = this.root.querySelector(Selectors.IMAGE.elements.sizeOriginal).checked;\r\n        if (constrain || sizeOriginal) {\r\n            // If the Auto size checkbox is checked or the Original size is checked, then apply the responsive class.\r\n            classList.push(Selectors.IMAGE.styles.responsive);\r\n        } else {\r\n            // Otherwise, remove it.\r\n            classList.pop(Selectors.IMAGE.styles.responsive);\r\n        }\r\n\r\n        return {\r\n            url: this.currentUrl,\r\n            alt: this.root.querySelector(Selectors.IMAGE.elements.alt).value,\r\n            width: this.root.querySelector(Selectors.IMAGE.elements.width).value,\r\n            height: this.root.querySelector(Selectors.IMAGE.elements.height).value,\r\n            presentation: this.root.querySelector(Selectors.IMAGE.elements.presentation).checked,\r\n            customStyle: this.root.querySelector(Selectors.IMAGE.elements.customStyle).value,\r\n            classlist: classList.join(' '),\r\n        };\r\n    }\r\n\r\n    setImage() {\r\n        const pendingPromise = new Pending('tiny_media:setImage');\r\n        const url = this.currentUrl;\r\n        if (url === '') {\r\n            return;\r\n        }\r\n\r\n        // Check if there are any accessibility issues.\r\n        if (this.updateWarning()) {\r\n            pendingPromise.resolve();\r\n            return;\r\n        }\r\n\r\n        // Check for invalid width or height.\r\n        const width = this.root.querySelector(Selectors.IMAGE.elements.width).value;\r\n        if (!isPercentageValue(width) && isNaN(parseInt(width, 10))) {\r\n            this.root.querySelector(Selectors.IMAGE.elements.width).focus();\r\n            pendingPromise.resolve();\r\n            return;\r\n        }\r\n\r\n        const height = this.root.querySelector(Selectors.IMAGE.elements.height).value;\r\n        if (!isPercentageValue(height) && isNaN(parseInt(height, 10))) {\r\n            this.root.querySelector(Selectors.IMAGE.elements.height).focus();\r\n            pendingPromise.resolve();\r\n            return;\r\n        }\r\n\r\n        Templates.render('tiny_media/image', this.getImageContext())\r\n        .then((html) => {\r\n            this.editor.insertContent(html);\r\n            this.currentModal.destroy();\r\n            pendingPromise.resolve();\r\n\r\n            return html;\r\n        })\r\n        .catch(error => {\r\n            window.console.log(error);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Deletes the image after confirming with the user and loads the insert image page.\r\n     */\r\n    deleteImage() {\r\n        Notification.deleteCancelPromise(\r\n            getString('deleteimage', 'tiny_media'),\r\n            getString('deleteimagewarning', 'tiny_media'),\r\n        ).then(() => {\r\n            hideElements(Selectors.IMAGE.elements.altWarning, this.root);\r\n            // Removing the image in the preview will bring the user to the insert page.\r\n            this.loadInsertImage();\r\n            return;\r\n        }).catch(error => {\r\n            window.console.log(error);\r\n        });\r\n    }\r\n\r\n    registerEventListeners() {\r\n        const submitAction = this.root.querySelector(Selectors.IMAGE.actions.submit);\r\n        submitAction.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            this.setImage();\r\n        });\r\n\r\n        const deleteImageEle = this.root.querySelector(Selectors.IMAGE.actions.deleteImage);\r\n        deleteImageEle.addEventListener('click', () => {\r\n            this.deleteImage();\r\n        });\r\n        deleteImageEle.addEventListener(\"keydown\", (e) => {\r\n            if (e.key === \"Enter\") {\r\n                this.deleteImage();\r\n            }\r\n        });\r\n\r\n        this.root.addEventListener('change', (e) => {\r\n            const presentationEle = e.target.closest(Selectors.IMAGE.elements.presentation);\r\n            if (presentationEle) {\r\n                this.presentationChanged();\r\n            }\r\n\r\n            const constrainEle = e.target.closest(Selectors.IMAGE.elements.constrain);\r\n            if (constrainEle) {\r\n                this.autoAdjustSize();\r\n            }\r\n\r\n            const sizeOriginalEle = e.target.closest(Selectors.IMAGE.elements.sizeOriginal);\r\n            if (sizeOriginalEle) {\r\n                this.sizeChecked('original');\r\n            }\r\n\r\n            const sizeCustomEle = e.target.closest(Selectors.IMAGE.elements.sizeCustom);\r\n            if (sizeCustomEle) {\r\n                this.sizeChecked('custom');\r\n            }\r\n        });\r\n\r\n        this.root.addEventListener('blur', (e) => {\r\n            if (e.target.nodeType === Node.ELEMENT_NODE) {\r\n\r\n                const presentationEle = e.target.closest(Selectors.IMAGE.elements.presentation);\r\n                if (presentationEle) {\r\n                    this.presentationChanged();\r\n                }\r\n            }\r\n        }, true);\r\n\r\n        // Character count.\r\n        this.root.addEventListener('keyup', (e) => {\r\n            const altEle = e.target.closest(Selectors.IMAGE.elements.alt);\r\n            if (altEle) {\r\n                this.handleKeyupCharacterCount();\r\n            }\r\n        });\r\n\r\n        this.root.addEventListener('input', (e) => {\r\n            const widthEle = e.target.closest(Selectors.IMAGE.elements.width);\r\n            if (widthEle) {\r\n                // Avoid empty value.\r\n                widthEle.value = widthEle.value === \"\" ? 0 : Number(widthEle.value);\r\n                this.autoAdjustSize();\r\n            }\r\n\r\n            const heightEle = e.target.closest(Selectors.IMAGE.elements.height);\r\n            if (heightEle) {\r\n                // Avoid empty value.\r\n                heightEle.value = heightEle.value === \"\" ? 0 : Number(heightEle.value);\r\n                this.autoAdjustSize(true);\r\n            }\r\n        });\r\n    }\r\n\r\n    handleKeyupCharacterCount() {\r\n        const alt = this.root.querySelector(Selectors.IMAGE.elements.alt).value;\r\n        const current = this.root.querySelector('#currentcount');\r\n        current.innerHTML = alt.length;\r\n    }\r\n\r\n    /**\r\n     * Calculates the dimensions to fit a square into a specified box while maintaining aspect ratio.\r\n     *\r\n     * @param {number} squareWidth - The width of the square.\r\n     * @param {number} squareHeight - The height of the square.\r\n     * @param {number} boxWidth - The width of the box.\r\n     * @param {number} boxHeight - The height of the box.\r\n     * @returns {Object} An object with the new width and height of the square to fit in the box.\r\n     */\r\n    fitSquareIntoBox = (squareWidth, squareHeight, boxWidth, boxHeight) => {\r\n        if (squareWidth < boxWidth && squareHeight < boxHeight) {\r\n          // If the square is smaller than the box, keep its dimensions.\r\n          return {\r\n            width: squareWidth,\r\n            height: squareHeight,\r\n          };\r\n        }\r\n        // Calculate the scaling factor based on the minimum scaling required to fit in the box.\r\n        const widthScaleFactor = boxWidth / squareWidth;\r\n        const heightScaleFactor = boxHeight / squareHeight;\r\n        const minScaleFactor = Math.min(widthScaleFactor, heightScaleFactor);\r\n        // Scale the square's dimensions based on the aspect ratio and the minimum scaling factor.\r\n        const newWidth = squareWidth * minScaleFactor;\r\n        const newHeight = squareHeight * minScaleFactor;\r\n        return {\r\n          width: newWidth,\r\n          height: newHeight,\r\n        };\r\n    };\r\n}\r\n"],"names":["_interopRequireDefault","e","__esModule","default","_config","_modal_events","_notification","_pending","_selectors","_templates","_exports","ImageDetails","DEFAULTS","WIDTH","HEIGHT","rawImageDimensions","constructor","root","editor","currentModal","canShowFilePicker","canShowDropZone","currentUrl","image","this","init","setTitle","getString","imageTypeChecked","presentationChanged","storeImageDimensions","setImageDimensions","registerEventListeners","loadInsertImage","async","templateContext","elementid","id","showfilepicker","showdropzone","Promise","all","bodyImageInsert","footerImageInsert","then","ImageInsert","catch","error","window","console","log","width","height","currentWidth","element","value","getCurrentWidth","querySelector","Selectors","IMAGE","elements","currentHeight","getCurrentHeight","preview","setAttribute","src","style","display","constrain","isPercentageValue","checked","disabled","widthRatio","Math","round","parseInt","heightRatio","setSelectedSize","sizeChecked","Number","option","widthInput","heightInput","sizeOriginalChecked","sizeCustomChecked","autoAdjustSize","forceHeight","arguments","length","undefined","widthField","heightField","normalizeFieldData","fieldData","field","percentValue","pixelSize","type","getKeyField","currentValue","keyField","relativeField","imagePreviewBox","previewBox","updateImageDimensions","boxWidth","clientWidth","boxHeight","clientHeight","dimensions","fitSquareIntoBox","getRoot","on","ModalEvents","shown","sizeOriginal","sizeCustom","hideElements","properties","showElements","presentation","alt","handleKeyupCharacterCount","isExternalUrl","RegExp","Config","wwwroot","test","url","setFilenameLabel","decodeURI","filename","split","pop","label","urlLabelEle","fileNameLabel","innerHTML","toggleAriaInvalid","selectors","predicate","forEach","selector","querySelectorAll","hasErrorUrlField","urlError","urlWarning","hasErrorAltField","imageAltError","altWarning","urlWaaltWarningrning","updateWarning","getImageContext","classList","push","styles","responsive","customStyle","classlist","join","setImage","pendingPromise","Pending","resolve","isNaN","focus","Templates","render","html","insertContent","destroy","deleteImage","Notification","deleteCancelPromise","actions","submit","addEventListener","preventDefault","deleteImageEle","key","target","closest","nodeType","Node","ELEMENT_NODE","widthEle","heightEle","squareWidth","squareHeight","widthScaleFactor","heightScaleFactor","minScaleFactor","min"],"mappings":"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"}