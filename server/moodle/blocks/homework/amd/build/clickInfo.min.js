define("block_homework/clickInfo",["exports","jquery","core/ajax","block_homework/modals","core/modal_events"],(function(_exports,_jquery,_ajax,_modals,_modal_events){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}
/**
   * Homework/amd/src/modal_homework.js
   *
   * @package
   * @copyright 2024, cs-24-sw-5-01 <cs-24-sw-5-01@student.aau.dk>
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   *
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_modals=_interopRequireDefault(_modals),_modal_events=_interopRequireDefault(_modal_events);_exports.init=async(title,data,user_id,completions)=>{let homeworkid,literaturelist=[],linkslist=[],videoslist=[];const buttons=document.getElementsByClassName("timebutton");for(let i=0;i<buttons.length;i++)buttons[i].addEventListener("click",(function(event){homeworkid=event.target.id,literaturelist=[],linkslist=[],videoslist=[];for(let item of data){if(!item.hasOwnProperty("id"))throw new Error("missing id in homework");if(item.id===homeworkid){if(!item.hasOwnProperty("literature"))throw new Error("missing id in homework");for(let literature of Object.values(item.literature))Object.values(completions).some((entry=>entry.literature_id===literature.id))||literaturelist.push(literature);if(!item.hasOwnProperty("links"))throw new Error("missing id in homework");for(let links of Object.values(item.links))Object.values(completions).some((entry=>entry.link_id===links.id))||linkslist.push(links);if(!item.hasOwnProperty("videos"))throw new Error("missing id in homework");for(let videos of Object.values(item.videos))Object.values(completions).some((entry=>entry.video_id===videos.id))||videoslist.push(videos)}}}));(0,_jquery.default)(document).ready((function(){(0,_jquery.default)(".timebutton").on("click",(()=>{_ajax.default.call([{methodname:"block_homework_get_infohomework_modal",args:{homework_id:homeworkid,data1:literaturelist,data2:linkslist,data3:videoslist},done:async function(response){const modal=await _modals.default.create({title:response.course+": "+response.title,body:`${response.html}`,large:!0,removeOnClose:!0});await modal.show(),modal.getRoot().on(_modal_events.default.shown,(()=>{})),modal.getRoot().on("click",'[data-action="submit"]',(e=>{e.preventDefault(),handleFormSubmit(user_id,modal)})),modal.getRoot().on("click",'[data-action="cancel"]',(e=>{e.preventDefault(),modal.destroy()}))},fail:error=>{throw new Error(`Failed to load info homework content: ${JSON.stringify(error)}`)}}])}))}))};const handleFormSubmit=(user_id,modal)=>{let literatureInputFields=document.querySelectorAll(".homework-time-literature"),linksInputFields=document.querySelectorAll(".homework-time-links"),videosInputFields=document.querySelectorAll(".homework-time-videos"),timeData1=[],timeData2=[],timeData3=[];for(let inputField of literatureInputFields)""!==inputField.value&&timeData1.push({id:inputField.id,time:inputField.value});for(let inputField of linksInputFields)""!==inputField.value&&timeData2.push({id:inputField.id,time:inputField.value});for(let inputField of videosInputFields)""!==inputField.value&&timeData3.push({id:inputField.id,time:inputField.value});timeData1.length||timeData2.length||timeData3.length?_ajax.default.call([{methodname:"block_homework_save_homeworktime",args:{user:user_id,timeCompletedLiterature:timeData1,timeCompletedLinks:timeData2,timeCompletedVideos:timeData3},done:function(response){console.log("Data saved successfully:",response),modal.destroy(),location.reload()},fail:function(error){console.error("Failed to save data:",error)}}]):modal.destroy()}}));

//# sourceMappingURL=clickInfo.min.js.map